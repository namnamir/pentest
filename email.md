## Tools
- [PhishTank](https://www.phishtank.com/)
- [CheckPhish](https://checkphish.ai/)
- [URLScan](https://urlscan.io)
- Email Dossier tools like [Dynu](https://www.dynu.com/en-US/NetworkTools/EmailDossier)
- Phishing simulators like [GoPhish](https://getgophish.com/)

## What cab be forged/spoofed in the email header?
| Field    | Can be forged? | What is does / Tips |
|----------|----------------|--------------------|
|Return-Path | Yes | • Delivery status notices are sent here<br>• Validated by SPF |
|Date | Yes | |
|Received | Partially | • All Received fields that have been added beforethe message arrives at your inbound email server could be forged<br>• Check that the data is technically correct e.g. timezonecorrelates to the actual time<br>• Check the layout and content is correct i.e. generally it should read as follows but does vary: `Received: from <sending_server_name> (<ip_address>) by <receiving_server_name> (<ip_address>) with <SMTP_server_software><ID><Date_Time_Timezone>`|
|Content | Yes | The content inside the email e.g. “Hi John, can you call me….”|
|Reply-To| Yes| Overrides the From address when replying |
|Message-ID |Yes| • These are generated by the client program sending the email (MUA) or by the first mail server<br>• No Message_IDlikely indicates a forgery as the majority of MUAs or MTAs should add this<br>• Look for repeated Message-IDs in your mail system –the ID has to be unique to the host that generates it so finding duplicates can indicate a forged email and allow you to identify other phishing messages<br>• Look for a Message-ID that does not correlate to the sending host. Most hosts use a specific format. For example, a valid LinkedIn email I received had:  `Message-ID: <312929037.8974629.1514954031062.JavaMail.app@lva1app3887.prod.linkedin.com>`<br>• Another common format is: DateTime.LocalhostDomainName|
|Subject| Yes||
|To, CC and BCC, From |Yes||
|Arbitrary headers e.g. X-Mailer|Partially| • Added by MTAs and security tools<br>• X-Fields created by your own MTA is trustworthy|
|Originating mail server |No||
|Subsequent timestamps|No||

## Countermeasures
### Domain Keys Identified Mail (DKIM)
**Goal**: verify that the sender really owns the sending domain and has permission to send from it

**How it helps**: It will stop malicious actors from stealing your email address to send email purporting to be from you

**How it works**:<br>
  • Essentially it is asymmetric encryption<br>
  • The sender MTA signs an email digitally with a private key and adds it to the header to verify it’s authenticity<br>
  • The receiving MTA verifies the signature through the signer’s public key i.e. it checks and matches<br>
  • This proves that the email has not been altered

**What is does NOT do**:<br>
  • It is not a spam filter –spammers also use valid DKIM<br>
  • It cannot be forged i.e. someone cannot use your DKIM signature as their own<br>
  • It does not encrypt your email content
 
 ### Sender Policy Framework (SPF)
 **Goal**:Prevent malicious actors from using forged email addresses
 
 **How it helps**: helps prevent sender address forgery
 
 **How it works**:<br>
 • Valid sender hosts are added to DNS by your company<br>
 • SPF checks the Return-Path field to validate the originating server<br>
 • Emails which return a “fail” status should generally be rejected by the receiving MTA<br>
 • "Received-SPF:" headers must be added above the standard SMTP "Received:" header for that MTA to avoid ambiguity about whether or not the header was added by a trusted MTA.
 
 **What it does NOT do**:<br>
 • Stop messages that fail SPF from reaching the recipient’s mailbox –but it improves the chances by adding another ‘layer’<br>
 • Stop spammers from using SPF on their OWN domains!
 
 
 ---
 #### Credits:
 - [Phishing Countermeasures Crourse](www.itmasters.edu.au) presented by Bianca Wirth
